<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U FORNU | Restaurant Traditionnel Ã  Calcatoggio</title>
    <meta name="description" content="DÃ©couvrez U FORNU d'Antony, restaurant traditionnel corse Ã  Calcatoggio. SpÃ©cialitÃ©s corses, pizzas au feu de bois, produits locaux entre Ajaccio et Sagone.">
    <meta name="keywords" content="U Fornu, Restaurant Calcatoggio, Pizzeria Corse, Restaurant Corse, SpÃ©cialitÃ©s corses, Pizza au feu de bois, Ajaccio, Sagone, Calcatoggio, meilleurs restaurants Corse, charcuterie corse">
    <link rel="canonical" href="http://ufornu-pizzeriacalcatoggio.com">
    <meta property="og:title" content="U FORNU | Restaurant Traditionnel Ã  Calcatoggio">
    <meta property="og:description" content="SpÃ©cialitÃ©s corses et pizzas au feu de bois Ã  U FORNU, entre Ajaccio et Sagone. Produits locaux et ambiance conviviale.">
    <meta property="og:type" content="restaurant.restaurant">
    <meta property="og:url" content="http://ufornu-pizzeriacalcatoggio.com">
    <meta property="og:image" content="URL_DE_VOTRE_IMAGE">
    <meta property="og:locale" content="fr_FR">
    <meta name="robots" content="index, follow">
    
    <!-- RÃ©fÃ©rences des bibliothÃ¨ques React -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>

    <style>
        /* Animation de pulsation pour le bouton de chat */
@keyframes pulse {
    0% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.1);
    }
    100% {
        transform: scale(1);
    }
}

/* Classe pour activer l'animation */
.pulse {
    animation: pulse 1s ease-in-out 3; /* L'animation dure 1 seconde et se rÃ©pÃ¨te 3 fois */
}
        :root {
            --color-wall: #f5e6c3;
            --color-shutter: #4a3428;
            --color-accent: #e63946;
            --color-text: #2b2b2b;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--color-wall);
            color: var(--color-text);
            line-height: 1.6;
        }
        
        .hero {
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('/api/placeholder/1200/600');
            background-size: cover;
            background-position: center;
            color: white;
            text-align: center;
            padding: 120px 20px;
        }
        
        .content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }
        
        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-left: 4px solid var(--color-accent);
        }
        
        h1, h2, h3 {
            color: var(--color-shutter);
        }
        
        .cta-button {
            display: inline-block;
            background: var(--color-accent);
            color: white;
            padding: 15px 30px;
            border-radius: 30px;
            text-decoration: none;
            margin-top: 20px;
            transition: background 0.3s;
        }
        
        .cta-button:hover {
            background: #c92834;
        }
        
        .chat-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--color-accent);
            color: white;
            padding: 15px;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 1000;
            font-size: 24px;
        }
        
        .chat-container {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: none;
            z-index: 1000;
            overflow: hidden;
        }
        
        @media (max-width: 768px) {
            .chat-container {
                width: calc(100% - 40px);
                height: 60vh;
                bottom: 90px;
            }
        }

        .message-animation {
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .suggestion-chip {
            display: inline-block;
            padding: 8px 16px;
            margin: 4px;
            background: #f0f0f0;
            border-radius: 20px;
            cursor: pointer;
            border: none;
            font-size: 14px;
            transition: all 0.2s;
        }

        .suggestion-chip:hover {
            background: #e0e0e0;
        }

        .chat-link {
            color: #0066cc;
            text-decoration: none;
        }

        .chat-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="hero">
    <h1 style="font-size: 3em; font-style: italic;">U FORNU</h1>
    <h2>Pizzeria au Four Ã  Bois Ancestral<br>et Restaurant Traditionnel Corse</h2>
    <a href="https://g.co/kgs/oGUEuZV" target="_blank" rel="noopener noreferrer" class="cta-button">RÃ©server une table</a>
</div>

    <div class="content">
        <section class="section">
            <h2>Notre Restaurant Ã  Calcatoggio</h2>
            <p>Entre Ajaccio et Sagone, Antony vous accueille dans son restaurant U FORNU. DÃ©couvrez nos spÃ©cialitÃ©s corses, nos pizzas au feu de bois et notre sÃ©lection de charcuterie locale.</p>
        </section>

        <div class="grid">
    <div class="card">
        <h3>ğŸ• Pizzas au Feu de Bois</h3>
        <p>Des pizzas cuites dans notre four traditionnel, prÃ©parÃ©es avec des produits locaux de qualitÃ©.</p>
    </div>
    <div class="card">
        <h3>ğŸ¥“ Charcuterie Corse</h3>
        <p>Une sÃ©lection des meilleures charcuteries corses artisanales de la rÃ©gion.</p>
    </div>
    <div class="card">
        <h3>ğŸ· Vins et Liqueurs</h3>
        <p>Une carte des vins corses et nos liqueurs maison Ã  dÃ©couvrir.</p>
    </div>
    <div class="card">
        <h3>ğŸ² Plats Corse</h3>
        <p>Le Mardi, câ€™est soupe Corse maison.<br>
           Le Jeudi, câ€™est veau Corse aux olives.</p>
        <p style="font-size: 0.9em; color: #555;">NB. RÃ©servation conseillÃ©e la veille</p>
    </div>
    <div class="card" style="border-left: 4px solid #d87f7f;">
        <h3>ğŸ‰ Ã‰vÃ©nements en haute saison</h3>
        <p>SoirÃ©e Corse : groupe de chanteur Corses, menu unique Ã  prix imbattable (entrÃ©e aux tomates, charcuterie corses, veau Corse aux olives et pÃ¢tes, dessert maison).</p>
        <p style="font-size: 0.85em; color: #555;">
            En gÃ©nÃ©ral, de fin juillet Ã  fin aoÃ»t ont lieu deux Ã  trois soirÃ©es spÃ©ciales (SoirÃ©e Corse et soirÃ©e DJ).<br>
            Nous vous conseillons de rÃ©server auprÃ¨s moins 15 jours Ã  lâ€™avance et de vous renseigner auprÃ¨s du chef pour les dates exactes.
        </p>
    </div>
</div>

        <section class="section">
    <p><strong>Note :</strong> Le paiement par carte de crÃ©dit n'est pas acceptÃ©.</p>
    <p><em>Credit card payments are not accepted.</em></p>
</section>

        <div id="chat-button" class="chat-button">ğŸ’¬</div>
        <div id="chat" class="chat-container"></div>
    </div>

    <script>
// Base de connaissances Ã©tendue
const KnowledgeBase = {
    contact: {
        telephone: "+33621146462",
        horaires_appel: "Ã  partir de 17h",
        adresse: "Calcatoggio village",
        maps_url: "https://maps.app.goo.gl/QQiBsitH5hcmQViTA",
        reservation_url: "https://maps.app.goo.gl/QQiBsitH5hcmQViTA"
    },
    horaires: {
        ouverture: "18h30",
        fermeture: "22h00",
        jours: "du mardi au dimanche",
        periode: "de fin mai au 11 novembre",
        evenements_speciaux: {
            mardi: "soupe corse traditionnelle",
            jeudi: "Veau Corse"
        }
    }, // â† Ici, ajouter une accolade fermante pour l'objet horaires
    langues: {
        commun: {
            salutations: {
                fr: ['bonjour', 'bonsoir', 'salut', 'coucou', 'hey'],
                en: ['hello', 'hi', 'hey', 'good morning', 'good evening'],
                de: ['hallo', 'guten tag', 'guten abend'],
                it: ['ciao', 'buongiorno', 'buonasera']
            },
            au_revoir: {
                fr: ['au revoir', 'bye', 'ciao', 'a bientot', 'Ã  bientÃ´t', 'adieu'],
                en: ['goodbye', 'bye', 'see you', 'farewell'],
                de: ['tschÃ¼ss', 'auf wiedersehen', 'ciao'],
                it: ['arrivederci', 'ciao', 'addio']
            }
        },
        concepts: {
            reservation: {
                fr: ['rÃ©sa', 'rÃ©servation', 'reservation', 'reserver', 'rÃ©server', 'table', 'place', 'booker', 'reservat'],
                en: ['book', 'booking', 'reserve', 'reservation', 'table'],
                de: ['reservierung', 'tisch', 'platz', 'buchen'],
                it: ['prenotazione', 'prenotare', 'tavolo', 'posto']
            },
            menu: {
                fr: ['carte', 'menu', 'plats', 'manger', 'cuisiner', 'nourriture', 'specialites', 'spÃ©cialitÃ©s', 'pizza'],
                en: ['menu', 'card', 'food', 'dishes', 'specialties', 'pizza'],
                de: ['speisekarte', 'menÃ¼', 'essen', 'pizza'],
                it: ['menu', 'carta', 'piatti', 'mangiare', 'pizza']
            },
            horaires: {
                fr: ['horaire', 'heure', 'ouvert', 'fermÃ©', 'ferme', 'ouverture', 'fermeture', 'quand'],
                en: ['hours', 'time', 'open', 'closed', 'opening', 'closing', 'when'],
                de: ['Ã¶ffnungszeiten', 'zeit', 'offen', 'geschlossen'],
                it: ['orari', 'ora', 'aperto', 'chiuso']
            },
            localisation: {
                fr: ['oÃ¹', 'adresse', 'place', 'endroit', 'route', 'chemin', 'accÃ¨s', 'trouver', 'emplacement', 'situe'],
                en: ['where', 'address', 'location', 'place', 'find', 'way'],
                de: ['wo', 'adresse', 'ort', 'standort'],
                it: ['dove', 'indirizzo', 'posto', 'luogo']
            },
            prix: {
                fr: ['prix', 'tarif', 'cout', 'coÃ»t', 'combien', 'cher'],
                en: ['price', 'cost', 'how much', 'expensive'],
                de: ['preis', 'kosten', 'wie viel'],
                it: ['prezzo', 'costo', 'quanto']
            }
        }
    }
};

// Fonction amÃ©liorÃ©e pour dÃ©tecter la langue
function detectLanguage(text) {
    const normalizedText = normalizeText(text);
    const langScores = {
        fr: 0,
        en: 0,
        de: 0,
        it: 0
    };

    // VÃ©rification des salutations et au revoir
    for (const type of ['salutations', 'au_revoir']) {
        for (const [lang, words] of Object.entries(KnowledgeBase.langues.commun[type])) {
            if (words.some(word => normalizedText.includes(word))) {
                langScores[lang] += 2; // Plus de poids pour les salutations
            }
        }
    }

    // VÃ©rification des concepts spÃ©cifiques
    for (const concept of Object.values(KnowledgeBase.langues.concepts)) {
        for (const [lang, words] of Object.entries(concept)) {
            if (words.some(word => normalizedText.includes(normalizeText(word)))) {
                langScores[lang] += 1;
            }
        }
    }

    // DÃ©terminer la langue dominante
    const maxScore = Math.max(...Object.values(langScores));
    const dominantLang = Object.entries(langScores).find(([_, score]) => score === maxScore)?.[0];

    return dominantLang || 'fr'; // FranÃ§ais par dÃ©faut
}

// Fonction pour normaliser le texte
function normalizeText(text) {
    return text.toLowerCase()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .replace(/[^a-z0-9\s]/g, "")
        .trim();
}

// Fonction pour identifier les intentions de l'utilisateur
function identifyUserIntent(text) {
    const normalizedText = normalizeText(text);
    const intents = new Set();

    // VÃ©rifier chaque concept
    for (const [concept, translations] of Object.entries(KnowledgeBase.langues.concepts)) {
        for (const words of Object.values(translations)) {
            if (words.some(word => normalizedText.includes(normalizeText(word)))) {
                intents.add(concept);
            }
        }
    }

    // DÃ©tection des Ã©vÃ©nements spÃ©ciaux
    if (normalizedText.includes('mardi') || normalizedText.includes('tuesday')) {
        intents.add('evenement_mardi');
    }
    if (normalizedText.includes('jeudi') || normalizedText.includes('thursday')) {
        intents.add('evenement_jeudi');
    }

    return Array.from(intents);
}

// SystÃ¨me de rÃ©ponses enrichi
const responses = {
    default: `Bonghjornu ! ğŸŒ Je suis lÃ  pour vous renseigner sur U FORNU. Comment puis-je vous aider ?

â€¢ Voir notre carte de pizzas et spÃ©cialitÃ©s ğŸ•
â€¢ Horaires et Ã©vÃ©nements spÃ©ciaux ğŸ“…
â€¢ RÃ©servation et contact â˜ï¸
â€¢ Nos produits locaux ğŸº`,

    english_default: `Hello! ğŸŒ I'm here to help you with information about U FORNU. 
Please contact Antony directly for English assistance:
ğŸ“± ${KnowledgeBase.contact.telephone}

He will be happy to help you in English! ğŸ˜Š`,

    german_default: `Hallo! ğŸŒ FÃ¼r Informationen auf Deutsch, kontaktieren Sie bitte Antony direkt:
ğŸ“± ${KnowledgeBase.contact.telephone}`,

    italian_default: `Ciao! ğŸŒ Per informazioni in italiano, contatta direttamente Antony:
ğŸ“± ${KnowledgeBase.contact.telephone}`,

    carte_pizzas: `ğŸ“‹ Voici nos pizzas prÃ©parÃ©es par Antony :

BASE TOMATE :
â€¢ Marguerite (tomate, fromage) - 9,50â‚¬
â€¢ Jambon Fromage - 10,00â‚¬
â€¢ Romaine (tomate, anchois, cÃ¢pres) - 10,00â‚¬
â€¢ Napolitaine (tomate, anchois, cÃ¢pres, fromage) - 10,80â‚¬
â€¢ Reine (tomate, jambon champignons, fromage) - 11,00â‚¬
â€¢ Chorizo (tomate, chorizo, champignons, fromage) - 11,50â‚¬
â€¢ Roi (tomate, jambon, champignons, Å“uf, fromage) - 11,50â‚¬
â€¢ ComplÃ¨te (tomate, jambon, champignons, anchois, Å“uf, fromage) - 11,80â‚¬
â€¢ Italiana (tomate, pepperoni, champignons, fromage) - 12,00â‚¬
â€¢ Corsica (tomate, jambon, champignons, Å“uf, figatellu, fromage) - 12,60â‚¬
â€¢ Special Fornu (tomate, jambon de Parme, champignons, roquette, fromage) - 13,00â‚¬

BASE CRÃˆME FRAÃCHE :
â€¢ Reine Blanche (crÃ¨me fraÃ®che, jambon, champignons, fromage) - 11,50â‚¬
â€¢ Dame Blanche (crÃ¨me fraÃ®che, jambon, champignons, Å“uf, fromage) - 11,80â‚¬
â€¢ Poulet Curry (crÃ¨me fraÃ®che, poulet, champignons, fromage, curry) - 12,00â‚¬`,

    evenements_speciaux: `ğŸ‰ Nos Ã©vÃ©nements spÃ©ciaux de la semaine :

â€¢ Mardi soir : Soupe corse traditionnelle ğŸ¥£
â€¢ Jeudi soir : Le Veau corse ğŸŒŸ

RÃ©servation conseillÃ©e le matin pour ces soirÃ©es !`,

    localisation: `ğŸ“ OÃ¹ nous trouver :

â€¢ Adresse : ${KnowledgeBase.contact.adresse}
â€¢ Entre Ajaccio (25 min) et Sagone (10 min)
â€¢ <a href="${KnowledgeBase.contact.maps_url}" target="_blank" rel="noopener noreferrer">Voir sur Google Maps</a>

ğŸš— Parking gratuit sur place
ğŸ“ En cas de difficultÃ© : ${KnowledgeBase.contact.telephone} (${KnowledgeBase.contact.horaires_appel})`,

    horaires: `â° Nos horaires :

â€¢ Ouvert ${KnowledgeBase.horaires.jours}
â€¢ Service : ${KnowledgeBase.horaires.ouverture} - ${KnowledgeBase.horaires.fermeture}
â€¢ PÃ©riode : ${KnowledgeBase.horaires.periode}

ğŸ“ RÃ©servation conseillÃ©e : ${KnowledgeBase.contact.telephone}
ğŸŒ RÃ©servez en ligne : ${KnowledgeBase.contact.reservation_url}`,

    reservation: `Pour rÃ©server une table chez U FORNU :

ğŸ“ Appelez Antony au ${KnowledgeBase.contact.telephone} (${KnowledgeBase.contact.horaires_appel})
ğŸŒ Ou rÃ©servez via Google : ${KnowledgeBase.contact.reservation_url}

â„¹ï¸ Conseil : La rÃ©servation le matin est recommandÃ©e, surtout en haute saison !`,

    incomprehension: `DÃ©solÃ©, je ne suis pas sÃ»r de bien comprendre... ğŸ¤”

Je peux vous renseigner sur :
â€¢ Nos pizzas et la carte
â€¢ Les horaires et Ã©vÃ©nements spÃ©ciaux
â€¢ L'adresse et l'accÃ¨s
â€¢ RÃ©servations et contact

Ou prÃ©fÃ©rez-vous parler directement Ã  Antony ? ğŸ“`,

    au_revoir: `Merci de votre intÃ©rÃªt pour U FORNU ! ğŸ™

Antony et son Ã©quipe seront ravis de vous accueillir.

Ã€ dopu ! ğŸ‘‹`,

    inactivity: "Y a-t-il autre chose que je puisse faire pour vous ? ğŸ˜Š"
};

// Fonction principale de rÃ©ponse amÃ©liorÃ©e
function getBotResponse(input) {
    if (!input.trim()) return responses.default;

    // VÃ©rification spÃ©cifique pour "soirÃ©e" et "soirÃ©es"
    if (input.toLowerCase().includes("soirÃ©e") || input.toLowerCase().includes("soirÃ©es")) {
        return `En plein cÅ“ur de la haute saison se dÃ©roulent deux Ã  trois soirÃ©es magiques : soirÃ©es chant Corses, soirÃ©e DJ, et leurs aftersâ€¦ Contactez le chef pour plus dâ€™infos ğŸ‘¨ğŸ»â€ğŸ³ğŸ“+33621146462`;
    }

    const normalizedInput = normalizeText(input);

    // RÃ©ponse automatique pour les mots-clÃ©s de contact
    if (normalizedInput.includes("contact") || 
        normalizedInput.includes("antony") || 
        normalizedInput.includes("tel") || 
        normalizedInput.includes("phone") || 
        normalizedInput.includes("tÃ©lÃ©phone") || 
        normalizedInput.includes("telefone") || 
        normalizedInput.includes("anto")) {
        return "ğŸ“ Contactez Antony au +33621146462 (Ã  partir de 17h)";
    }
    
// RÃ©ponse automatique pour les produits locaux et charcuterie
if (normalizedInput.includes("produits") || 
    normalizedInput.includes("charcuterie") || 
    normalizedInput.includes("confitures") || 
    normalizedInput.includes("liqueurs") || 
    normalizedInput.includes("confiture") || 
    normalizedInput.includes("liqueur") || 
    normalizedInput.includes("coppa") || 
    normalizedInput.includes("lonzo") || 
    normalizedInput.includes("livraison") || 
    normalizedInput.includes("commande") || 
    normalizedInput.includes("colis") || 
    normalizedInput.includes("vin") || 
    normalizedInput.includes("wine") || 
    normalizedInput.includes("liquor") || 
    normalizedInput.includes("alcool")) {
    return `Venez dÃ©guster nos produits Corses authentiques. Le chef vous propose confitures maison, liqueurs maison, charcuteries Corses (lonzo, coppa, saucisson).
    <br><small>Vous Ãªtes reparti sur le continent ? Je compatisâ€¦ Mais bonne nouvelle, vous pouvez appeler AntonyğŸ‘¨ğŸ»â€ğŸ³ pour passer commande et il vous enverra les produits par la poste.
    ğŸ“+33621146462</small>`;
}

    // Correction de la rÃ©ponse pour la localisation
if (normalizedInput.includes("lieu") ||
    normalizedInput.includes("location") ||
    normalizedInput.includes("localisation") ||
    normalizedInput.includes("where") ||
    normalizedInput.includes("adress") ||
    normalizedInput.includes("adresse")) {
    return `ğŸ“ OÃ¹ nous trouver :
    <br>â€¢ Adresse : ${KnowledgeBase.contact.adresse}
    <br>â€¢ Entre Ajaccio (25 min) et Sagone (10 min)
    <br>â€¢ <a href="${KnowledgeBase.contact.maps_url}" target="_blank" rel="noopener noreferrer">Voir sur Google Maps</a>
    <br>ğŸš— Parking gratuit sur place
    <br>ğŸ“ En cas de difficultÃ© : ${KnowledgeBase.contact.telephone} (${KnowledgeBase.contact.horaires_appel})`;
}
    
// RÃ©ponse automatique pour les Ã©vÃ©nements et soirÃ©es
if (normalizedInput.includes("Ã©vÃ©nements") || 
    normalizedInput.includes("Ã©vÃ¨nement") || 
    normalizedInput.includes("Ã©vÃ¨nements") || 
    normalizedInput.includes("event") || 
    normalizedInput.includes("events") || 
    normalizedInput.includes("soirÃ©e") || 
    normalizedInput.includes("soirÃ©es") || 
    normalizedInput.includes("night") || 
    normalizedInput.includes("nights") || 
    normalizedInput.includes("bal") || 
    normalizedInput.includes("bals") || 
    normalizedInput.includes("fÃªte") || 
    normalizedInput.includes("fÃªtes") || 
    normalizedInput.includes("evenement") || 
    normalizedInput.includes("evenements")) {
    return `En plein cÅ“ur de la haute saison se dÃ©roulent deux Ã  trois soirÃ©es magiques : soirÃ©es chant Corses, soirÃ©e DJ, et leurs aftersâ€¦ Contactez le chef pour plus dâ€™infos ğŸ‘¨ğŸ»â€ğŸ³ğŸ“+33621146462`;
}
    
// RÃ©ponse automatique pour les insultes
if (normalizedInput.includes("connard") || 
    normalizedInput.includes("pd") || 
    normalizedInput.includes("enculÃ©") || 
    normalizedInput.includes("pute") || 
    normalizedInput.includes("salope") || 
    normalizedInput.includes("con") || 
    normalizedInput.includes("sodomie") || 
    normalizedInput.includes("sodomiser") || 
    normalizedInput.includes("enculer") || 
    normalizedInput.includes("encule") || 
    normalizedInput.includes("puta") || 
    normalizedInput.includes("gogole") || 
    normalizedInput.includes("debile") || 
    normalizedInput.includes("idiot") || 
    normalizedInput.includes("cabron")) {
    return `ğŸª¬Votre adresse IP mobile et votre numÃ©ro de tÃ©lÃ©phone ont Ã©tÃ© enregistrÃ©s.`;
}

// RÃ©ponse automatique pour les moyens de paiements
if (normalizedInput.includes("moyens de paiements") || 
    normalizedInput.includes("tickets restaurant") || 
    normalizedInput.includes("espÃ¨ces") || 
    normalizedInput.includes("cash") || 
    normalizedInput.includes("carte bleu") || 
    normalizedInput.includes("carte bancaire") || 
    normalizedInput.includes("chÃ¨que") || 
    normalizedInput.includes("pay") || 
    normalizedInput.includes("payement") || 
    normalizedInput.includes("paye") || 
    normalizedInput.includes("payer") || 
    normalizedInput.includes("crÃ©dit card") || 
    normalizedInput.includes("paiement") || 
    normalizedInput.includes("paiements")) {
    return `âš ï¸ NO CRÃ‰DIT CARD. Paiements acceptÃ©s : espÃ¨ces/cash, chÃ¨que, ou ticket restaurants.`;
}

// RÃ©ponse automatique pour les cigarettes
if (normalizedInput.includes("cigarette") || 
    normalizedInput.includes("cigarettes") || 
    normalizedInput.includes("cigaret") || 
    normalizedInput.includes("cigarets") || 
    normalizedInput.includes("tabac")) {
    return `La maison ne vend pas de cigarettes. Â« Le tabac câ€™est tabou, on en viendra tous Ã  bout Â» (pour ceux qui ont la rÃ©f).`;
}
    
// RÃ©ponse automatique pour les pinsutti
if (normalizedInput.includes("pinsuttu") || 
    normalizedInput.includes("pinsutu") || 
    normalizedInput.includes("pinsuntu") || 
    normalizedInput.includes("pinzutu") || 
    normalizedInput.includes("pinzzutu") || 
    normalizedInput.includes("pinzuttu")) {
    return `Gaulois, vient te dÃ©lecter dans ma taverne et nâ€™oublie pas dâ€™apporter ta bienveillance.`;
}

// RÃ©ponse automatique pour l'accessibilitÃ© handicap
if (normalizedInput.includes("handicap") || 
    normalizedInput.includes("handicapped") || 
    normalizedInput.includes("handicapÃ©") || 
    normalizedInput.includes("handicapÃ©s") || 
    normalizedInput.includes("fauteuil") || 
    normalizedInput.includes("fauteuil roulant") || 
    normalizedInput.includes("PMR") || 
    normalizedInput.includes("mobilitÃ© rÃ©duite")) {
    return `Le restaurant et sa terrasse (en terre dure) sont au mÃªme niveau de la route. Donc accessibles aux personnes Ã  mobilitÃ© rÃ©duite, nÃ©anmoins les toilettes ne sont malheureusement pas adaptÃ©es. Elles sont standards, la porte dâ€™entrÃ©e est standard.`;
}

// RÃ©ponse automatique pour la soupe et le veau
if (normalizedInput.includes("soupe") || 
    normalizedInput.includes("veau") || 
    normalizedInput.includes("mardi") || 
    normalizedInput.includes("jeudi") || 
    normalizedInput.includes("soum") || 
    normalizedInput.includes("viande") || 
    normalizedInput.includes("meat")) {
    return `La soupe câ€™est le mardi soir, le veau Corse aux olives le jeudi soir.
    <br>Je vous conseille de rÃ©server la veille ou plus tÃ´t.`;
}

    const language = detectLanguage(input); // Mettez cette ligne aprÃ¨s le bloc `if` pour Ã©viter tout problÃ¨me.
    const intents = identifyUserIntent(input);
    let response = '';

    // Gestion des langues Ã©trangÃ¨res
    if (language !== 'fr') {
        switch (language) {
            case 'en': return responses.english_default;
            case 'de': return responses.german_default;
            case 'it': return responses.italian_default;
            default: return responses.english_default;
        }
    }

    // DÃ©tection des au revoir
    if (KnowledgeBase.langues.commun.au_revoir.fr.some(word => 
        normalizedInput.includes(normalizeText(word)))) {
        return responses.au_revoir;
    }

    // Traitement des intentions multiples
    if (intents.length > 0) {
        const responsesParts = [];

        intents.forEach(intent => {
            switch (intent) {
                case 'menu':
                    responsesParts.push(responses.carte_pizzas);
                    break;
                case 'reservation':
                    responsesParts.push(responses.reservation);
                    break;
                case 'horaires':
                    responsesParts.push(responses.horaires);
                    break;
                case 'localisation':
                    responsesParts.push(responses.localisation);
                    break;
                case 'evenement_mardi':
                    responsesParts.push("ğŸ¥£ Le mardi soir, nous servons notre dÃ©licieuse soupe corse traditionnelle !");
                    break;
                case 'evenement_jeudi':
                    responsesParts.push("ğŸŒŸ Le jeudi soir, c'est le Veau Corse !");
                    break;
            }
        });

        if (responsesParts.length > 0) {
            response = responsesParts.join('\n\n');
            // Ajout des Ã©vÃ©nements spÃ©ciaux si pertinent
            if (intents.includes('menu') || intents.includes('horaires')) {
                response += '\n\n' + responses.evenements_speciaux;
            }
        }
    }

    // Si aucune intention n'est dÃ©tectÃ©e
    return response || responses.incomprehension;
}

// Composant React du ChatBot
function ChatBot() {
    const [messages, setMessages] = React.useState([{
        text: responses.default,
        sender: 'bot'
    }]);
    const [input, setInput] = React.useState('');
    const [isTyping, setIsTyping] = React.useState(false);
    const messagesEndRef = React.useRef(null);

    const scrollToBottom = () => {
        messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
    };

    React.useEffect(() => {
        scrollToBottom();
    }, [messages]);

    // Gestionnaire d'inactivitÃ©
    React.useEffect(() => {
        let inactivityTimer;
        const resetInactivityTimer = () => {
            clearTimeout(inactivityTimer);
            inactivityTimer = setTimeout(() => {
                if (messages.length > 1 && messages[messages.length - 1].sender === 'user') {
                    setMessages(prev => [...prev, {
                        text: responses.inactivity,
                        sender: 'bot'
                    }]);
                }
            }, 300000); // 5 minutes
        };

        resetInactivityTimer();
        return () => clearTimeout(inactivityTimer);
    }, [messages]);

    const handleSubmit = (e) => {
        e.preventDefault();
        if (!input.trim()) return;

        const userMessage = input;
        setMessages(prev => [...prev, { text: userMessage, sender: 'user' }]);
        setInput('');
        setIsTyping(true);

        // Simulation d'un dÃ©lai de rÃ©ponse naturel
        setTimeout(() => {
            const botResponse = getBotResponse(userMessage);
            setMessages(prev => [...prev, { text: botResponse, sender: 'bot' }]);
            setIsTyping(false);
        }, Math.random() * 1000 + 500); // DÃ©lai alÃ©atoire entre 500ms et 1500ms
    };

    return React.createElement('div', { 
        style: { height: '100%', display: 'flex', flexDirection: 'column' }
    },
        React.createElement('div', { 
            style: { 
                background: 'var(--color-shutter)',
                color: 'white',
                padding: '15px',
                textAlign: 'center',
                borderRadius: '15px 15px 0 0',
                position: 'relative'
            }
        }, 
            "ğŸ’¬ U FORNU - Questions & RÃ©servations",
            React.createElement('button', {
                onClick: () => document.getElementById('chat').style.display = 'none',
                style: {
                    position: 'absolute',
                    top: '5px',
                    right: '10px',
                    background: 'transparent',
                    color: 'white',
                    border: 'none',
                    fontSize: '18px',
                    cursor: 'pointer'
                }
            }, "âœ•")
        ),

        React.createElement('div', { 
            style: { 
                flex: 1,
                overflow: 'auto',
                padding: '15px',
                background: '#f8f9fa'
            }
        },
            messages.map((msg, idx) => 
                React.createElement('div', { 
                    key: idx,
                    className: 'message-animation',
                    style: {
                        textAlign: msg.sender === 'user' ? 'right' : 'left',
                        margin: '8px'
                    }
                },
                React.createElement('span', {
                    dangerouslySetInnerHTML: { __html: msg.sender === 'bot' ? 
                        formatText(msg.text) : msg.text },
                    style: {
                        background: msg.sender === 'user' ? 
                            'var(--color-accent)' : 'white',
                        color: msg.sender === 'user' ? 'white' : 'var(--color-text)',
                        padding: '10px 15px',
                        borderRadius: '20px',
                        display: 'inline-block',
                        maxWidth: '80%',
                        boxShadow: '0 2px 5px rgba(0,0,0,0.1)',
                        whiteSpace: 'pre-wrap'
                    }
                })
            )),
            isTyping && React.createElement('div', { 
                className: 'message-animation',
                style: {
                    textAlign: 'left',
                    margin: '8px'
                }
            }, 
                React.createElement('span', {
                    style: {
                        background: 'white',
                        padding: '10px 15px',
                        borderRadius: '20px',
                        display: 'inline-block',
                        boxShadow: '0 2px 5px rgba(0,0,0,0.1)',
                    }
                }, "âœï¸ En train d'Ã©crire...")
            ),
            React.createElement('div', { ref: messagesEndRef })
        ),

        React.createElement('form', { 
            onSubmit: handleSubmit,
            style: { 
                padding: '15px',
                background: 'white',
                borderTop: '1px solid #eee'
            }
        },
            React.createElement('div', { style: { display: 'flex', gap: '10px' } },
                React.createElement('input', {
                    value: input,
                    onChange: (e) => setInput(e.target.value),
                    placeholder: "Votre question...",
                    style: {
                        flex: 1,
                        padding: '10px',
                        borderRadius: '25px',
                        border: '1px solid #ddd',
                        outline: 'none'
                    }
                }),
                React.createElement('button', {
                    type: 'submit',
                    style: {
                        padding: '10px 20px',
                        borderRadius: '25px',
                        border: 'none',
                        background: 'var(--color-accent)',
                        color: 'white',
                        cursor: 'pointer'
                    }
                }, "Envoyer")
            )
        )
    );
}

// Fonction pour rendre les liens cliquables
function formatText(text) {
    const formattedText = text
        .replace(/(https?:\/\/[^\s]+)/g, (url) => {
            return `<a href="${url}" target="_blank" rel="noopener noreferrer" class="chat-link">Voir sur Google Maps</a>`;
        })
        .replace(/(\+\d{11})/g, '<a href="tel:$1" class="chat-link">$1</a>');
    return formattedText;
}

// Initialisation du chat
        document.addEventListener('DOMContentLoaded', () => {
            const chatButton = document.getElementById('chat-button');
            const chatContainer = document.getElementById('chat');
            let chatVisible = false;

            chatButton.addEventListener('click', () => {
                chatVisible = !chatVisible;
                chatContainer.style.display = chatVisible ? 'block' : 'none';
            });

            ReactDOM.render(
                React.createElement(ChatBot),
                document.getElementById('chat')
            );

            // Ajouter une animation de pulsation aprÃ¨s 30 secondes, en dehors du clic
            setTimeout(() => {
                chatButton.classList.add('pulse');
            }, 5000); // 5 secondes
        });
    </script>
</body>
</html>
